name: Snyk PR Check

# Trigger the workflow on pull request events
on: [pull_request]

jobs:
  snyk-test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Run Snyk Test
        env:
          SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
          SNYK_ORG: ${{ secrets.SNYK_ORG }}
        run: |
          docker run --rm \
            -v "${{ github.workspace }}:/project" \
            -w /project \
            -e SNYK_TOKEN="${{ secrets.SNYK_TOKEN }}" \
            snyk/snyk:docker-latest test --file=Dockerfile | tee snyk-output.log

      - name: Display Snyk Test Results
        run: cat snyk-output.log
